/** 
 * easyDialog v2.0
 * Url : http://stylechen.com/easydialog-v2.0.html
 * Author : chenmnkken@gmail.com
 * Date : 2011-08-30
 */
(function(j,o){var d=j.document,p=d.documentElement,w=function(){var m=d.body,s=!-[1,],q=s&&/msie 6/.test(navigator.userAgent.toLowerCase()),n=1,t="cache"+(+new Date+"").slice(-8),l={},e=function(){};e.prototype={getOptions:function(a){var b,c={},f={container:null,overlay:!0,drag:!0,fixed:!0,follow:null,followX:0,followY:0,autoClose:0,lock:!1,callback:null};for(b in f)c[b]=a[b]!==o?a[b]:f[b];e.data("options",c);return c},setBodyBg:function(){if(m.currentStyle.backgroundAttachment!==
"fixed")m.style.backgroundImage="url(about:blank)",m.style.backgroundAttachment="fixed"},appendIframe:function(a){a.innerHTML='<iframe style="position:absolute;left:0;top:0;width:100%;height:100%;z-index:-1;border:0 none;filter:alpha(opacity=0)"></iframe>'},setFollow:function(a,b,c,f){b=typeof b==="string"?d.getElementById(b):b;a=a.style;a.position="absolute";a.left=e.getOffset(b,"left")+c+"px";a.top=e.getOffset(b,"top")+f+"px"},setPosition:function(a,b){var c=a.style;c.position=q?"absolute":b?"fixed":
"absolute";b?(q?c.setExpression("top",'fuckIE6=document.documentElement.scrollTop+document.documentElement.clientHeight/2+"px"'):c.top="50%",c.left="50%"):(q&&c.removeExpression("top"),c.top=p.clientHeight/2+e.getScroll("top")+"px",c.left=p.clientWidth/2+e.getScroll("left")+"px")},createOverlay:function(){var a=d.createElement("div"),b=a.style;b.cssText="margin:0;padding:0;border:none;width:100%;height:100%;background:#333;opacity:0.6;filter:alpha(opacity=60);z-index:9999;position:fixed;top:0;left:0;";
if(q)m.style.height="100%",b.position="absolute",b.setExpression("top",'fuckIE6=document.documentElement.scrollTop+"px"');a.id="overlay";return a},createDialogBox:function(){var a=d.createElement("div");a.style.cssText="margin:0;padding:0;border:none;z-index:10000;";a.id="easyDialogBox";return a},createDialogWrap:function(a){var b=typeof a.yesFn==="function"?'<button class="btn_highlight" id="easyDialogYesBtn">'+(typeof a.yesText==="string"?a.yesText:"\u786e\u5b9a")+"</button>":"",c=typeof a.noFn===
"function"||a.noFn===!0?'<button class="btn_normal" id="easyDialogNoBtn">'+(typeof a.noText==="string"?a.noText:"\u53d6\u6d88")+"</button>":"",a=['<div class="easyDialog_content">',a.header?'<h4 class="easyDialog_title" id="easyDialogTitle"><a href="javascript:void(0)" title="\u5173\u95ed\u7a97\u53e3" class="close_btn" id="closeBtn">&times;</a>'+a.header+"</h4>":"",'<div class="easyDialog_text">'+a.content+"</div>",b===""&&c===""?"":'<div class="easyDialog_footer">'+c+b+"</div>","</div>"].join(""),
b=d.getElementById("easyDialogWrapper");if(!b)b=d.createElement("div"),b.id="easyDialogWrapper",b.className="easyDialog_wrapper";b.innerHTML=a.replace(/<[\/]*script[\s\S]*?>/ig,"");return b}};e.data=function(a,b,c){if(typeof a==="string")return b!==o&&(l[a]=b),l[a];else if(typeof a==="object")return a=a===j?0:a.nodeType===9?1:a[t]?a[t]:a[t]=++n,a=l[a]?l[a]:l[a]={},c!==o&&(a[b]=c),a[b]};e.removeData=function(a,b){if(typeof a==="string")delete l[a];else if(typeof a==="object"){var c=a===j?0:a.nodeType===
9?1:a[t];if(c!==o){var e=function(a){for(var b in a)return!1;return!0},g=function(){delete l[c];if(!(c<=1))try{delete a[t]}catch(b){a.removeAttribute(t)}};b?(delete l[c][b],e(l[c])&&g()):g()}}};e.event={bind:function(a,b,c){var f=e.data(a,"e"+b)||e.data(a,"e"+b,[]);f.push(c);f.length===1&&(c=this.eventHandler(a),e.data(a,b+"Handler",c),a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c))},unbind:function(a,b,c){var f=e.data(a,"e"+b);if(f){if(c)for(var g=f.length-1,
d=f[g];g>=0;g--)d===c&&f.splice(g,1);else f=o;if(!f||!f.length)c=e.data(a,b+"Handler"),a.addEventListener?a.removeEventListener(b,c,!1):a.attachEvent&&a.detachEvent("on"+b,c),e.removeData(a,b+"Handler"),e.removeData(a,"e"+b)}},eventHandler:function(a){return function(b){for(var b=e.event.fixEvent(b||j.event),c=e.data(a,"e"+b.type),f=0,g;g=c[f++];)g.call(a,b)===!1&&(b.preventDefault(),b.stopPropagation())}},fixEvent:function(a){if(a.target)return a;var b={},c;b.target=a.srcElement||document;b.preventDefault=
function(){a.returnValue=!1};b.stopPropagation=function(){a.cancelBubble=!0};for(c in a)b[c]=a[c];return b}};e.capitalize=function(a){var b=a.charAt(0);return b.toUpperCase()+a.replace(b,"")};e.getScroll=function(a){a=this.capitalize(a);return p["scroll"+a]||m["scroll"+a]};e.getOffset=function(a,b){var c=this.capitalize(b),c=p["client"+c]||m["client"+c]||0,e=this.getScroll(b),g=a.getBoundingClientRect();return Math.round(g[b])+e-c};e.drag=function(a,b){var c="getSelection"in j?function(){j.getSelection().removeAllRanges()}:
function(){try{d.selection.empty()}catch(a){}},f=this,g=f.event,i=!1,h=s?a:d,k=b.style.position==="fixed",m=e.data("options").fixed;g.bind(a,"mousedown",function(c){i=!0;var d=f.getScroll("top"),j=f.getScroll("left"),o=k?0:j,r=k?0:d;e.data("dragData",{x:c.clientX-f.getOffset(b,"left")+(k?j:0),y:c.clientY-f.getOffset(b,"top")+(k?d:0),el:o,et:r,er:o+p.clientWidth-b.offsetWidth,eb:r+p.clientHeight-b.offsetHeight});s&&(q&&m&&b.style.removeExpression("top"),a.setCapture());g.bind(h,"mousemove",l);g.bind(h,
"mouseup",n);s&&g.bind(a,"losecapture",n);c.stopPropagation();c.preventDefault()});var l=function(a){if(i){c();var d=e.data("dragData"),f=a.clientX-d.x,g=a.clientY-d.y,h=d.et,k=d.er,m=d.eb,d=d.el,j=b.style;j.marginLeft=j.marginTop="0px";j.left=(f<=d?d:f>=k?k:f)+"px";j.top=(g<=h?h:g>=m?m:g)+"px";a.stopPropagation()}},n=function(c){i=!1;s&&g.unbind(a,"losecapture",arguments.callee);g.unbind(h,"mousemove",l);g.unbind(h,"mouseup",arguments.callee);if(s&&(a.releaseCapture(),q&&m)){var d=parseInt(b.style.top)-
f.getScroll("top");b.style.setExpression("top","fuckIE6=document.documentElement.scrollTop+"+d+'+"px"')}c.stopPropagation()}};var r,u=function(a){a.keyCode===27&&v.close()},v={open:function(a){var b=new e,c=b.getOptions(a||{}),a=e.event,f=this,g,i,h,k;r&&(clearTimeout(r),r=o);if(c.overlay)g=d.getElementById("overlay"),g||(g=b.createOverlay(),m.appendChild(g),q&&b.appendIframe(g)),g.style.display="block";q&&b.setBodyBg();i=d.getElementById("easyDialogBox");i||(i=b.createDialogBox(),m.appendChild(i));
if(c.follow){b.setFollow(i,c.follow,c.followX,c.followY);if(g)g.style.display="none";c.fixed=!1}else b.setPosition(i,c.fixed);i.style.display="block";!c.follow&&!c.fixed&&(h=function(){b.setPosition(i,!1)},a.bind(j,"resize",h),e.data("resize",h));h=typeof c.container==="string"?d.getElementById(c.container):b.createDialogWrap(c.container);if(k=i.getElementsByTagName("*")[0]){if(k&&h!==k)k.style.display="none",m.appendChild(k),i.appendChild(h)}else i.appendChild(h);h.style.display="block";k=h.offsetWidth;
var l=h.offsetHeight;h.style.marginTop=h.style.marginRight=h.style.marginBottom=h.style.marginLeft="0px";c.follow?i.style.marginLeft=i.style.marginTop="0px":(i.style.marginLeft="-"+k/2+"px",i.style.marginTop="-"+l/2+"px");if(q&&!c.overlay)i.style.width=k+"px",i.style.height=l+"px";h=d.getElementById("closeBtn");k=d.getElementById("easyDialogTitle");var l=d.getElementById("easyDialogYesBtn"),n=d.getElementById("easyDialogNoBtn");l&&a.bind(l,"click",function(a){c.container.yesFn.call(f,a)!==!1&&f.close()});
if(n){var p=function(a){(c.container.noFn===!0||c.container.noFn.call(f,a)!==!1)&&f.close()};a.bind(n,"click",p);h&&a.bind(h,"click",p)}else h&&a.bind(h,"click",f.close);c.lock||a.bind(d,"keyup",u);c.autoClose&&typeof c.autoClose==="number"&&(r=setTimeout(f.close,c.autoClose));if(c.drag&&k)k.style.cursor="move",e.drag(k,i);e.data("dialogElements",{overlay:g,dialogBox:i,closeBtn:h,dialogTitle:k,dialogYesBtn:l,dialogNoBtn:n})},close:function(){var a=e.data("options"),b=e.data("dialogElements"),c=e.event;
r&&(clearTimeout(r),r=o);if(a.overlay&&b.overlay)b.overlay.style.display="none";b.dialogBox.style.display="none";q&&b.dialogBox.style.removeExpression("top");b.closeBtn&&c.unbind(b.closeBtn,"click");b.dialogTitle&&c.unbind(b.dialogTitle,"mousedown");b.dialogYesBtn&&c.unbind(b.dialogYesBtn,"click");b.dialogNoBtn&&c.unbind(b.dialogNoBtn,"click");!a.follow&&!a.fixed&&(b=e.data("resize"),c.unbind(j,"resize",b),e.removeData("resize"));a.lock||c.unbind(d,"keyup",u);typeof a.callback==="function"&&a.callback.call(v);
e.removeData("options");e.removeData("dialogElements")}};return v},n=function(){j.easyDialog=w()},u=function(){if(!d.body){try{p.doScroll("left")}catch(j){setTimeout(u,1);return}n()}};(function(){if(d.body)n();else if(d.addEventListener)d.addEventListener("DOMContentLoaded",function(){d.removeEventListener("DOMContentLoaded",arguments.callee,!1);n()},!1),j.addEventListener("load",n,!1);else if(d.attachEvent){d.attachEvent("onreadystatechange",function(){d.readyState==="complete"&&(d.detachEvent("onreadystatechange",
arguments.callee),n())});j.attachEvent("onload",n);var m=!1;try{m=j.frameElement==null}catch(o){}p.doScroll&&m&&u()}})()})(window,void 0);
